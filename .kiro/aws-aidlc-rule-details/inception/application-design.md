# 应用程序设计 - 详细步骤

## 目的
**高级组件识别和服务层设计**

应用程序设计专注于：
- 识别主要功能组件及其职责
- 定义组件接口（不是详细的业务逻辑）
- 为编排设计服务层
- 建立组件依赖关系和通信模式

**注意**：详细的业务逻辑设计稍后在功能设计（每单元，构建阶段）中进行

## 先决条件
- 上下文评估必须完成
- 推荐需求评估（提供功能上下文）
- 推荐故事开发（用户故事指导设计决策）
- 执行计划必须指示应执行应用程序设计阶段

## 逐步执行

### 1. 分析上下文
- 阅读 `aidlc-docs/inception/requirements/requirements.md` 和 `aidlc-docs/inception/user-stories/stories.md`
- 识别关键业务能力和功能领域
- 确定设计范围和复杂性

### 2. 创建应用程序设计计划
- 生成带复选框 [] 的应用程序设计计划
- 专注于组件、职责、方法、业务规则和服务
- 每个步骤和子步骤都应该有复选框 []

### 3. 在计划中包含必需的设计工件
- **始终**在设计计划中包含这些必需的工件：
  - [ ] 生成 components.md，包含组件定义和高级职责
  - [ ] 生成 component-methods.md，包含方法签名（业务规则稍后在功能设计中详述）
  - [ ] 生成 services.md，包含服务定义和编排模式
  - [ ] 生成 component-dependency.md，包含依赖关系和通信模式
  - [ ] 验证设计完整性和一致性

### 4. 生成上下文相关的问题
**指令**：分析需求和故事，仅生成与此特定应用程序设计相关的问题。使用以下类别作为灵感，而不是强制性检查清单。如果不适用，跳过整个类别。

- 使用 [Answer]: 标签格式嵌入问题
- 专注于此上下文特定的歧义和缺失信息
- 仅在设计决策需要用户输入时生成问题

**示例问题类别**（根据需要调整）：
- **组件识别** - 仅当组件边界或组织不清楚时
- **组件方法** - 仅当方法签名需要澄清时（详细业务规则稍后进行）
- **服务层设计** - 仅当服务编排或边界模糊时
- **组件依赖关系** - 仅当通信模式或依赖管理不清楚时
- **设计模式** - 仅当架构风格或模式选择需要用户输入时

### 5. 存储应用程序设计计划
- 保存为 `aidlc-docs/inception/plans/application-design-plan.md`
- 包含所有用户输入的 [Answer]: 标签
- 确保计划涵盖所有设计方面

### 6. 请求用户输入
- 要求用户直接在计划文档中填写 [Answer]: 标签
- 强调设计决策的重要性
- 提供完成 [Answer]: 标签的明确说明

### 7. 收集答案
- 等待用户使用文档中的 [Answer]: 标签提供所有问题的答案
- 在所有 [Answer]: 标签完成之前不要继续
- 审查文档以确保没有 [Answer]: 标签留空

### 8. 分析答案（必需）
在继续之前，您必须仔细审查所有用户答案：
- **模糊或含糊的回应**："混合"、"介于之间"、"不确定"、"取决于"
- **未定义的标准或术语**：引用没有明确定义的概念
- **矛盾的答案**：相互冲突的回应
- **缺失的设计细节**：缺乏具体指导的答案
- **组合选项的答案**：在没有明确决策规则的情况下合并不同方法的回应

### 9. 必需的后续问题
如果步骤 8 中的分析揭示任何模糊答案，您必须：
- 使用 [Answer]: 标签向计划文档添加具体的后续问题
- 在所有歧义解决之前不要继续批准
- 必需后续问题的示例：
  - "您提到了'A 和 B 的混合' - 什么具体标准应该决定何时使用 A 与 B？"
  - "您说'介于 A 和 B 之间' - 您能定义确切的中间方法吗？"
  - "您表示'不确定' - 什么额外信息会帮助您决定？"
  - "您提到'取决于复杂性' - 您如何定义复杂性级别？"

### 10. 生成应用程序设计工件
- 执行批准的计划以生成设计工件
- 创建 `aidlc-docs/inception/application-design/components.md`，包含：
  - 组件名称和目的
  - 组件职责
  - 组件接口
- 创建 `aidlc-docs/inception/application-design/component-methods.md`，包含：
  - 每个组件的方法签名
  - 每个方法的高级目的
  - 输入/输出类型
  - 注意：详细业务规则将在功能设计（每单元，构建阶段）中定义
- 创建 `aidlc-docs/inception/application-design/services.md`，包含：
  - 服务定义
  - 服务职责
  - 服务交互和编排
- 创建 `aidlc-docs/inception/application-design/component-dependency.md`，包含：
  - 显示关系的依赖矩阵
  - 组件间的通信模式
  - 数据流图

### 11. 记录批准
- 在 `aidlc-docs/audit.md` 中记录带时间戳的批准提示
- 包含完整的批准提示文本
- 使用 ISO 8601 时间戳格式

### 12. 展示完成消息

```markdown
# 🏗️ 应用程序设计完成

[AI 生成的应用程序设计工件创建摘要，以项目符号形式]

> **📋 <u>**需要审查：**</u>**  
> 请检查应用程序设计工件：`aidlc-docs/inception/application-design/`

> **🚀 <u>**下一步？**</u>**
>
> **您可以：**
>
> 🔧 **请求变更** - 如需要，要求修改应用程序设计
> [如果跳过单元生成：]
> 📝 **添加单元生成** - 选择包含 **单元生成** 阶段（当前跳过）
> ✅ **批准并继续** - 批准设计并继续到 **[单元生成/构建阶段]**
```

### 13. 等待明确批准
- 在用户明确批准应用程序设计之前不要继续
- 批准必须清楚明确
- 如果用户请求变更，更新设计并重复批准过程

### 14. 记录批准响应
- 在 `aidlc-docs/audit.md` 中记录用户的批准响应和时间戳
- 包含确切的用户响应文本
- 清楚标记批准状态

### 15. 更新进度
- 在 `aidlc-docs/aidlc-state.md` 中标记应用程序设计阶段完成
- 更新"当前状态"部分
- 准备过渡到下一阶段
