# 问题格式指南

## 必须：所有问题必须使用此格式

### 规则：永远不要在聊天中提问
**关键**：您绝不能直接在聊天中提问。所有问题必须放在专用问题文件中。

### 问题文件格式

#### 文件命名约定
- 使用描述性名称：`{阶段名称}-questions.md`
- 示例：
  - `classification-questions.md`
  - `requirements-questions.md`
  - `story-planning-questions.md`
  - `design-questions.md`

#### 问题结构
每个问题必须包含有意义的选项加上"其他"作为最后选项：

```markdown
## 问题 [编号]
[清晰、具体的问题文本]

A) [第一个有意义的选项]
B) [第二个有意义的选项]
[...根据需要添加其他选项...]
X) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

**关键**：
- "其他"是每个问题的必须最后选项
- 只包含有意义的选项 - 不要编造选项来填充位置
- 使用合理数量的选项（最少2个 + 其他）

### 完整示例

```markdown
# 需求澄清问题

请回答以下问题以帮助澄清需求。

## 问题 1
主要的用户身份验证方法是什么？

A) 用户名和密码
B) 社交媒体登录（Google、Facebook）
C) 单点登录（SSO）
D) 多因素身份验证
E) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 

## 问题 2
这将是Web应用程序还是移动应用程序？

A) Web应用程序
B) 移动应用程序
C) Web和移动都有
D) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 

## 问题 3
这是新项目还是现有代码库？

A) 新项目（绿地）
B) 现有代码库（棕地）
C) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

### 用户响应格式
用户将通过在 [Answer]: 标签后填写字母选择来回答：

```markdown
## 问题 1
主要的用户身份验证方法是什么？

A) 用户名和密码
B) 社交媒体登录（Google、Facebook）
C) 单点登录（SSO）
D) 多因素身份验证

[Answer]: C
```

### 读取用户响应
用户确认完成后：
1. 读取问题文件
2. 提取 [Answer]: 标签后的答案
3. 验证所有问题都已回答
4. 基于响应进行分析

### 多选指导原则

#### 选项数量
- 最少：2个有意义选项 + "其他"（A、B、C）
- 典型：3-4个有意义选项 + "其他"（A、B、C、D、E）
- 最多：5个有意义选项 + "其他"（A、B、C、D、E、F）
- **关键**：不要编造选项来填充位置 - 只包含有意义的选择

#### 选项质量
- 使选项互斥
- 涵盖最常见的场景
- 只包含有意义、现实的选项
- **始终包含"其他"作为最后选项**（必须）
- 具体明确
- **不要编造选项来填充A、B、C、D位置**

#### 好的示例：
```markdown
## 问题 5
将使用什么数据库技术？

A) 关系型（PostgreSQL、MySQL）
B) NoSQL文档（MongoDB、DynamoDB）
C) NoSQL键值（Redis、Memcached）
D) 图数据库（Neo4j、Neptune）
E) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

#### 坏的示例（避免）：
```markdown
## 问题 5
您将使用什么数据库？

A) 是
B) 否
C) 也许

[Answer]: 
```

### 工作流集成

#### 步骤1：创建问题文件
```markdown
创建 aidlc-docs/{阶段名称}-questions.md 包含所有问题
```

#### 步骤2：通知用户
```
"我已创建 {阶段名称}-questions.md 包含 [X] 个问题。
请通过在 [Answer]: 标签后填写字母选择来回答每个问题。
如果没有选项符合您的需求，请选择最后一个选项（其他）并描述您的偏好。完成后请告诉我。"
```

#### 步骤3：等待确认
等待用户说"完成"、"已完成"、"结束"或类似的话。

#### 步骤4：读取和分析
```
读取 aidlc-docs/{阶段名称}-questions.md
提取所有答案
验证完整性
进行分析
```

### 错误处理

#### 缺少答案
如果任何 [Answer]: 标签为空：
```
"我注意到问题 [X] 没有回答。请在继续之前为所有问题提供答案，使用其中一个字母选择。"
```

#### 无效答案
如果答案不是有效的字母选择：
```
"问题 [X] 的答案 '[答案]' 无效。
请只使用问题中提供的字母选择。"
```

#### 模糊答案
如果用户提供解释而不是字母：
```
"对于问题 [X]，请提供最符合您答案的字母选择。
如果没有匹配的，请选择'其他'并在 [Answer]: 标签后添加您的描述。"
```

### 矛盾和歧义检测

**必须**：读取用户响应后，您必须检查矛盾和歧义。

#### 检测矛盾
寻找逻辑不一致的答案：
- 范围不匹配："错误修复"但"整个代码库受影响"
- 风险不匹配："低风险"但"破坏性变更"
- 时间线不匹配："快速修复"但"多个子系统"
- 影响不匹配："单个组件"但"重大架构变更"

#### 检测歧义
寻找不清楚或边界响应：
- 可能适合多个分类的答案
- 缺乏特异性的响应
- 多个问题间的冲突指标

#### 创建澄清问题
如果检测到矛盾或歧义：

1. **创建澄清文件**：`{阶段名称}-clarification-questions.md`
2. **解释问题**：清楚说明检测到什么矛盾/歧义
3. **提出针对性问题**：使用多选格式解决问题
4. **引用原始问题**：显示哪些问题有冲突答案

**示例**：
```markdown
# [阶段名称] 澄清问题

我在您的响应中检测到需要澄清的矛盾：

## 矛盾 1：[简要描述]
您指出了"[答案A]"（Q[X]:[字母]）但也指出了"[答案B]"（Q[Y]:[字母]）。
这些响应是矛盾的，因为[解释]。

### 澄清问题 1
[解决矛盾的具体问题]

A) [解决第一个答案的选项]
B) [解决第二个答案的选项]
C) [提供中间立场的选项]
D) [重新构建问题的选项]

[Answer]: 

## 歧义 1：[简要描述]
您对Q[X]的响应（"[答案]"）是模糊的，因为[解释]。

### 澄清问题 2
[澄清歧义的具体问题]

A) [清晰选项1]
B) [清晰选项2]
C) [清晰选项3]
D) [清晰选项4]

[Answer]: 
```

#### 澄清工作流

1. **检测**：分析所有响应的矛盾/歧义
2. **创建**：如果发现问题则生成澄清问题文件
3. **通知**：告诉用户问题和澄清文件
4. **等待**：在用户提供澄清之前不要继续
5. **重新验证**：澄清后，再次检查一致性
6. **继续**：只有在所有矛盾解决后才继续

#### 示例用户消息
```
"我在您的响应中检测到2个矛盾：

1. 错误修复范围 vs. 代码库影响（Q1 vs Q2）
2. 低风险 vs. 破坏性变更（Q7 vs Q4）

我已创建 classification-clarification-questions.md 包含2个问题来解决这些问题。
请在我继续分类之前回答这些澄清问题。"
```

### 最佳实践

1. **具体明确**：问题应该清晰无歧义
2. **全面覆盖**：涵盖所有必要信息
3. **简洁明了**：保持问题专注于一个主题
4. **实用可行**：选项应该现实可操作
5. **保持一致**：在所有问题文件中使用相同格式

### 阶段特定示例

#### 2个有意义选项的示例：
```markdown
## 问题 1
这是新项目还是现有代码库？

A) 新项目（绿地）
B) 现有代码库（棕地）
C) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

#### 3个有意义选项的示例：
```markdown
## 问题 2
部署目标是什么？

A) 云（AWS、Azure、GCP）
B) 本地服务器
C) 混合（云和本地都有）
D) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

#### 4个有意义选项的示例：
```markdown
## 问题 3
应该使用什么架构模式？

A) 单体架构
B) 微服务架构
C) 无服务器架构
D) 事件驱动架构
E) 其他（请在下面的 [Answer]: 标签后描述）

[Answer]: 
```

## 总结

**记住**：
- ✅ 始终创建问题文件
- ✅ 始终使用多选格式
- ✅ **始终包含"其他"作为最后选项（必须）**
- ✅ 只包含有意义的选项 - 不要编造选项来填充位置
- ✅ 始终使用 [Answer]: 标签
- ✅ 始终等待用户完成
- ✅ 始终验证响应的矛盾
- ✅ 如需要始终创建澄清文件
- ✅ 在继续之前始终解决矛盾
- ❌ 永远不要在聊天中提问
- ❌ 永远不要编造选项只是为了有A、B、C、D
- ❌ 永远不要在没有答案的情况下继续
- ❌ 永远不要在有未解决矛盾的情况下继续
- ❌ 永远不要对模糊响应做假设
